{
  "metadata": {
    "study_id": "MAXIS-08",
    "source_domain": "HEMLAB.csv",
    "target_domain": "LB",
    "sdtm_version": "SDTM-IG 3.4",
    "created_by": "SDTM Mapping Generator",
    "created_date": "2026-02-02T09:36:01.782791",
    "description": "Mapping specification for LB domain transformation"
  },
  "source_files": [
    {
      "filename": "HEMLAB.csv",
      "records": 1726,
      "columns": 14
    }
  ],
  "variable_mappings": [
    {
      "sdtm_variable": "STUDYID",
      "label": "Study Identifier",
      "type": "Char",
      "core": "Req",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Study identifier from STUDY column ('MAXIS-08')"
    },
    {
      "sdtm_variable": "DOMAIN",
      "label": "Domain Abbreviation",
      "type": "Char",
      "core": "Req",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Constant value 'LB' for Laboratory domain"
    },
    {
      "sdtm_variable": "USUBJID",
      "label": "Unique Subject Identifier",
      "type": "Char",
      "core": "Req",
      "source_column": "",
      "transformation": null,
      "transformation_type": "CONCAT",
      "controlled_terminology": null,
      "comments": "Unique subject identifier concatenating study, site (INVSITE='C008_408'), and patient (PT='01-01')"
    },
    {
      "sdtm_variable": "LBSEQ",
      "label": "Sequence Number",
      "type": "Num",
      "core": "Req",
      "source_column": "",
      "transformation": null,
      "transformation_type": "SEQUENCE",
      "controlled_terminology": null,
      "comments": "Sequence number per subject ordered by visit, repeat sequence, and lab parameter"
    },
    {
      "sdtm_variable": "LBTESTCD",
      "label": "Lab Test or Examination Short Name",
      "type": "Num",
      "core": "Req",
      "source_column": "LPARM",
      "transformation": "Map to LBTESTCD controlled terminology: HEMOGLOBIN->HGB, HEMATOCRIT->HCT, WBC->WBC, NEUTROPHILS->NEUT, LYMPHOCYTES->LYMPH, etc.",
      "transformation_type": "MAP",
      "controlled_terminology": "LBTESTCD",
      "comments": "Lab test short code derived from LPARM (e.g., 'HEMOGLOBIN' maps to 'HGB'). Handle LABQSN for additional tests like GRANULOCYTES->GRAN, IG->IG"
    },
    {
      "sdtm_variable": "LBTEST",
      "label": "Lab Test or Examination Name",
      "type": "Char",
      "core": "Req",
      "source_column": "LPARM",
      "transformation": "Map to LBTEST controlled terminology: HEMOGLOBIN->Hemoglobin, HEMATOCRIT->Hematocrit, WBC->Leukocytes, NEUTROPHILS->Neutrophils, LYMPHOCYTES->Lymphocytes, etc.",
      "transformation_type": "MAP",
      "controlled_terminology": "LBTEST",
      "comments": "Lab test full name derived from LPARM. Use LABQSN if LPARM is null. Convert to proper case/standard terminology"
    },
    {
      "sdtm_variable": "LBCAT",
      "label": "Category for Lab Test",
      "type": "Char",
      "core": "Exp",
      "source_column": "DCMNAME",
      "transformation": "Map 'LAB_HAEM' to 'HEMATOLOGY'",
      "transformation_type": "MAP",
      "controlled_terminology": null,
      "comments": "Category for lab test. DCMNAME='LAB_HAEM' indicates Hematology tests"
    },
    {
      "sdtm_variable": "LBORRES",
      "label": "Result or Finding in Original Units",
      "type": "Char",
      "core": "Exp",
      "source_column": "LVALUE2",
      "transformation": "Convert numeric to character, preserving original precision",
      "transformation_type": "COPY",
      "controlled_terminology": null,
      "comments": "Original lab result as collected. Source LVALUE2 has null_count=210 indicating some missing results"
    },
    {
      "sdtm_variable": "LBORRESU",
      "label": "Original Units",
      "type": "Num",
      "core": "Exp",
      "source_column": "LUNIT2",
      "transformation": "Use LUNIT2 if available, otherwise use LUNIT1",
      "transformation_type": "DERIVE",
      "controlled_terminology": "UNIT",
      "comments": "Original units. LUNIT2 has values like 'G/DL', '10^3/UL' (null_count=1210). LUNIT1 has 'G/L', '%', '10^9/L' (no nulls). Prefer LUNIT2 when available"
    },
    {
      "sdtm_variable": "LBORNRLO",
      "label": "Reference Range Lower Limit in Orig Unit",
      "type": "Char",
      "core": "Exp",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Reference range lower limit in original units. Not present in source; requires external reference range lookup based on LBTESTCD, age, gender"
    },
    {
      "sdtm_variable": "LBORNRHI",
      "label": "Reference Range Upper Limit in Orig Unit",
      "type": "Char",
      "core": "Exp",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Reference range upper limit in original units. Not present in source; requires external reference range lookup"
    },
    {
      "sdtm_variable": "LBSTRESC",
      "label": "Character Result/Finding in Std Format",
      "type": "Char",
      "core": "Exp",
      "source_column": "LVALUE2",
      "transformation": "Convert to character in standard format, handle missing as empty string",
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Character result in standard format. Same as LBORRES unless standardization needed"
    },
    {
      "sdtm_variable": "LBSTRESN",
      "label": "Numeric Result/Finding in Standard Units",
      "type": "Num",
      "core": "Exp",
      "source_column": "LVALUE2",
      "transformation": "Use numeric value directly after unit standardization",
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Numeric result in standard units. Apply conversion if standardizing from LUNIT2 to LUNIT1 or standard SI units"
    },
    {
      "sdtm_variable": "LBSTRESU",
      "label": "Standard Units",
      "type": "Char",
      "core": "Exp",
      "source_column": "LUNIT1",
      "transformation": "Map to standard CDISC UNIT codelist",
      "transformation_type": "MAP",
      "controlled_terminology": "UNIT",
      "comments": "Standard units. LUNIT1 appears to be standardized units (G/L, %, 10^9/L). Map '10^9/L' to 'E9/L', verify % context"
    },
    {
      "sdtm_variable": "LBSTNRLO",
      "label": "Reference Range Lower Limit-Std Units",
      "type": "Num",
      "core": "Exp",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Reference range lower limit in standard units. Derive from LBORNRLO with unit conversion"
    },
    {
      "sdtm_variable": "LBSTNRHI",
      "label": "Reference Range Upper Limit-Std Units",
      "type": "Num",
      "core": "Exp",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Reference range upper limit in standard units. Derive from LBORNRHI with unit conversion"
    },
    {
      "sdtm_variable": "LBNRIND",
      "label": "Reference Range Indicator",
      "type": "Char",
      "core": "Exp",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": "NRIND",
      "comments": "Reference range indicator. Derive by comparing LBSTRESN to reference ranges. Values: NORMAL, ABNORMAL, HIGH, LOW"
    },
    {
      "sdtm_variable": "LBSPEC",
      "label": "Specimen Type",
      "type": "Char",
      "core": "Exp",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": "SPECTYPE",
      "comments": "Specimen type. For HEMATOLOGY (LBCAT), typically 'BLOOD' or 'WHOLE BLOOD'. Not in source, derive from LBCAT or external metadata"
    },
    {
      "sdtm_variable": "LBBLFL",
      "label": "Baseline Flag",
      "type": "Char",
      "core": "Perm",
      "source_column": "CPEVENT",
      "transformation": "IF CPEVENT = 'BASELINE' AND QUALIFYV = 1 THEN 'Y' ELSE NULL",
      "transformation_type": "DERIVE",
      "controlled_terminology": "NY",
      "comments": "Baseline flag. Set to 'Y' for baseline visit where CPEVENT='BASELINE' and QUALIFYV=1 (qualifying visit)"
    },
    {
      "sdtm_variable": "VISITNUM",
      "label": "Visit Number",
      "type": "Char",
      "core": "Exp",
      "source_column": "VISIT",
      "transformation": "Use numeric visit number directly",
      "transformation_type": "COPY",
      "controlled_terminology": null,
      "comments": "Visit number from VISIT column (values 1-998, with 998 likely representing unscheduled visits)"
    },
    {
      "sdtm_variable": "VISIT",
      "label": "Visit Name",
      "type": "Char",
      "core": "Exp",
      "source_column": "CPEVENT",
      "transformation": "Use visit name from CPEVENT",
      "transformation_type": "COPY",
      "controlled_terminology": null,
      "comments": "Visit name from CPEVENT (e.g., 'BASELINE'). Contains descriptive visit labels"
    },
    {
      "sdtm_variable": "LBDTC",
      "label": "Date/Time of Specimen Collection",
      "type": "Char",
      "core": "Exp",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DATE_FORMAT",
      "controlled_terminology": null,
      "comments": "Date/Time of specimen collection in ISO 8601 format. Not present in provided source columns - requires date field from EDC"
    },
    {
      "sdtm_variable": "LBDY",
      "label": "Study Day of Specimen Collection",
      "type": "Num",
      "core": "Perm",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DATE_FORMAT",
      "controlled_terminology": null,
      "comments": "Study day of specimen collection. Requires reference start date (RFSTDTC) from DM domain"
    },
    {
      "sdtm_variable": "LBSPID",
      "label": "Sponsor-Defined Identifier",
      "type": "Char",
      "core": "Perm",
      "source_column": "REPEATSN",
      "transformation": "Use as sponsor-defined identifier for repeat/replicate tests",
      "transformation_type": "COPY",
      "controlled_terminology": null,
      "comments": "Sponsor-defined identifier. REPEATSN indicates repeat sequence number (1-10) which can identify replicate samples"
    },
    {
      "sdtm_variable": "LBSTAT",
      "label": "Completion Status",
      "type": "Char",
      "core": "Perm",
      "source_column": "QUALIFYV",
      "transformation": "IF LVALUE2 IS NULL THEN 'NOT DONE' ELSE NULL",
      "transformation_type": "DERIVE",
      "controlled_terminology": "ND",
      "comments": "Completion status. Set to 'NOT DONE' when LBORRES is null (210 records). QUALIFYV=2 may also indicate non-qualifying/not done"
    },
    {
      "sdtm_variable": "LBREASND",
      "label": "Reason Not Done",
      "type": "Char",
      "core": "Perm",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Reason test not done. Not present in source data - would need additional field to capture reason"
    },
    {
      "sdtm_variable": "LBSCAT",
      "label": "Subcategory for Lab Test",
      "type": "Char",
      "core": "Perm",
      "source_column": "SUBEVE",
      "transformation": "Map SUBEVE to subcategory: 0='SCHEDULED', 1='UNSCHEDULED', 2='REPEAT'",
      "transformation_type": "MAP",
      "controlled_terminology": null,
      "comments": "Subcategory for lab test. SUBEVE values (0,1,2) may indicate scheduled vs unscheduled collection timing"
    },
    {
      "sdtm_variable": "LBNAM",
      "label": "Vendor Name",
      "type": "Char",
      "core": "Perm",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Laboratory vendor name. Not in source data - requires external metadata or separate vendor tracking"
    },
    {
      "sdtm_variable": "LBMETHOD",
      "label": "Method of Test or Examination",
      "type": "Char",
      "core": "Perm",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": "METHOD",
      "comments": "Method of test or examination. Not in source - requires lab procedure documentation"
    },
    {
      "sdtm_variable": "LBFAST",
      "label": "Fasting Status",
      "type": "Char",
      "core": "Perm",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": "NY",
      "comments": "Fasting status (Y/N). Not in source - requires separate fasting status data collection"
    },
    {
      "sdtm_variable": "LBDRVFL",
      "label": "Derived Flag",
      "type": "Char",
      "core": "Perm",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": "NY",
      "comments": "Derived flag. Set to 'Y' if lab value is calculated (e.g., ratios, differentials calculated from absolute counts)"
    },
    {
      "sdtm_variable": "EPOCH",
      "label": "Epoch",
      "type": "Char",
      "core": "Perm",
      "source_column": "",
      "transformation": null,
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Trial epoch (e.g., SCREENING, TREATMENT, FOLLOW-UP). Requires trial visit mapping"
    },
    {
      "sdtm_variable": "SITEID",
      "label": "SITEID",
      "type": "Char",
      "core": "Perm",
      "source_column": "INVSITE",
      "transformation": "Extract site portion from INVSITE (e.g., '408' from 'C008_408')",
      "transformation_type": "DERIVE",
      "controlled_terminology": null,
      "comments": "Study site identifier. INVSITE format 'C008_408' appears to be country_site"
    }
  ],
  "derivation_rules": {
    "LBSEQ": "ROW_NUMBER() OVER (PARTITION BY USUBJID ORDER BY LBDTC)",
    "USUBJID": "STUDYID || '-' || SITEID || '-' || SUBJID",
    "DOMAIN": "'LB'",
    "LBSTRESC": "LBORRES converted to standard format",
    "LBSTRESN": "Numeric conversion of LBSTRESC where applicable",
    "LBNRIND": "Derived: 'NORMAL' if LBSTNRLO <= LBSTRESN <= LBSTNRHI, 'LOW' if < LBSTNRLO, 'HIGH' if > LBSTNRHI",
    "LBBLFL": "'Y' for baseline records, null otherwise",
    "STUDYID": "STUDY",
    "LBORRESU": "COALESCE(LUNIT2, LUNIT1)",
    "LBORNRLO": "Derive from reference data or metadata if available",
    "LBORNRHI": "Derive from reference data or metadata if available",
    "LBSTNRLO": "Apply same conversion factor as LBSTRESN",
    "LBSTNRHI": "Apply same conversion factor as LBSTRESN",
    "LBSPEC": "'BLOOD' or 'SERUM' based on test category",
    "LBDTC": "Requires date/time from source not provided in sample. Look for date columns in full dataset",
    "LBDY": "(LBDTC_DATE - RFSTDTC_DATE) + 1 if LBDTC >= RFSTDTC, else (LBDTC_DATE - RFSTDTC_DATE)",
    "LBREASND": "Populate when LBSTAT='NOT DONE'. Requires reason field from source",
    "LBNAM": "Derive from external lab vendor information if available",
    "LBMETHOD": "Derive from lab manual or metadata based on LBTESTCD",
    "LBFAST": "Derive from visit requirements or fasting status field if available",
    "LBDRVFL": "'Y' for calculated/derived lab values, NULL for directly measured",
    "EPOCH": "Map from trial visits or TV domain based on VISITNUM",
    "SITEID": "SUBSTR(INVSITE, INSTR(INVSITE, '_') + 1)"
  },
  "controlled_terminologies": {
    "LBNRIND": [
      "NORMAL",
      "ABNORMAL",
      "LOW",
      "HIGH",
      "ABNORMAL LOW",
      "ABNORMAL HIGH"
    ]
  },
  "data_quality_rules": []
}